# Класс Formatter

Класс `Formatter` предоставляет утилиты для преобразования объектов задач (`Task`, `Epic`, `Subtask`) в строки CSV-формата и обратно. Используется для сохранения и восстановления состояния менеджера задач в файл.

---

## Методы

### 1. `public static Task fromString(String str)`

**Назначение**: Создает объект задачи из строки CSV.  
**Параметры**:
- `str` (String) - строка в формате:  
  `id,type,name,status,description[,epicId]`.

**Возвращает**:
- Объект `Task`, `Epic` или `Subtask` (в зависимости от типа в строке).
- `null` — если строка некорректна или возникла ошибка парсинга.

#### Формат строки:
| Тип       | Пример строки                                                                 |
|-----------|------------------------------------------------------------------------------|
| `TASK`    | `1, TASK, Изучить Java, NEW, Пройти курс по многопоточности`                |
| `EPIC`    | `2, EPIC, Релиз продукта, IN_PROGRESS, Подготовка к выпуску`                 |
| `SUBTASK` | `3, SUBTASK, Написать тесты, DONE, Реализовать юнит-тесты, 2` (последнее число — `epicId`) |

#### Логика работы:
1. Разбивает строку на части по запятым.
2. Определяет тип задачи.
3. Создает объект соответствующего класса, заполняя поля:
    - `id`, `title`, `status`, `description`.
    - Для `Subtask` дополнительно парсит `epicId`.

**Исключения**:
- `NullPointerException` — если передана пустая строка.
- `IllegalArgumentException` — если количество частей строки меньше 5 или тип задачи неизвестен.
- `NumberFormatException` — если `id` или `epicId` не являются числами.

---

### 2. `public static String toString(Task task)`

**Назначение**: Преобразует задачу в строку CSV.  
**Параметры**:
- `task` (Task) - объект задачи (может быть `Epic`, `Subtask`).

**Возвращает**:
- Строку в формате CSV (см. примеры выше).

#### Особенности:
- Для `Subtask` добавляет `epicId` в конец строки.
- Тип задачи определяется через `getClass().getSimpleName()` (например, `Subtask` → `"Subtask"`).

---

## Пример использования

### Сериализация задачи в CSV
```java
Task task = new Task(1, "Изучить Java", "Пройти курс", Status.NEW);
String csv = Formatter.toString(task); 
// Результат: "1, Task, Изучить Java, NEW, Пройти курс"
```
### Десериализация из CSV
```java
String line = "3, Subtask, Тестирование, DONE, Написать тесты, 2";
Subtask subtask = (Subtask) Formatter.fromString(line);
System.out.println(subtask.getEpicId()); // 2
```
## Примечания

### Ограничения:

Тип задачи в CSV должен точно соответствовать имени класса (Task, Epic, Subtask).

Статус (status) должен существовать в перечислении Status.

### Совместимость:

Формат CSV должен строго соблюдаться. Добавление новых полей в классы задач потребует изменения методов Formatter.

### Обработка ошибок:

Метод fromString() возвращает null при ошибках. В реальных проектах рекомендуется использовать исключения или логирование.

### Использование в менеджере:

FileBackedTaskManager использует Formatter для автосохранения задач в файл.

При восстановлении данных из файла связи между Subtask и Epic восстанавливаются автоматически.

## Связь с другими классами
#### 1. FileBackedTaskManager
   Класс FileBackedTaskManager напрямую зависит от Formatter:

При сохранении данных в файл вызывает Formatter.toString(task) для преобразования задач в CSV-строки.

При восстановлении состояния из файла использует Formatter.fromString(line), чтобы десериализовать строки в объекты 
Task, Epic или Subtask.

Управление связями между эпиками и подзадачами (например, обновление списка subtaskIds в Epic) происходит
внутри метода loadFromFile(), где Formatter помогает восстановить структуру данных.

#### 2. Классы задач (Task, Epic, Subtask)
   Formatter работает с объектами этих классов:

Сериализация: Извлекает данные из полей (id, title, status, description, epicId для подзадач) и формирует строку.

Десериализация: Создает новые экземпляры классов на основе распарсенных данных. Например, для Subtask передает epicId 
в конструктор, чтобы сохранить связь с родительским эпиком.

Классы задач не зависят от Formatter — их роль пассивна (предоставляют данные для преобразования).

#### 3. ManagerSaveException
   Исключение ManagerSaveException используется в FileBackedTaskManager для обработки ошибок 
ввода-вывода при работе с файлами. Хотя Formatter не генерирует это исключение напрямую, ошибки парсинга данных 
(например, некорректный формат строки) могут привести к его возникновению на уровне менеджера.

#### 4. InMemoryTaskManager
   FileBackedTaskManager наследует функциональность базового менеджера InMemoryTaskManager, 
расширяя его методами автосохранения. Все изменения в задачах (добавление, обновление, 
удаление) сначала обрабатываются через родительский класс, а затем триггер save() записывает обновленные данные в файл.

#### 5. Enum Status
   Перечисление Status используется в Formatter для корректного преобразования статуса задачи 
из строки (например, "IN_PROGRESS") в объект типа Status при десериализации. Обратное преобразование (объект → 
строка) происходит при сериализации через метод status.toString().

## Итоговая архитектура
Formatter выступает мостом между объектной моделью задач (Task, Epic, Subtask) и файловым хранилищем. 
FileBackedTaskManager интегрирует его в логику работы, обеспечивая сохранение состояния приложения без 
изменения бизнес-логики родительского класса InMemoryTaskManager.