# Класс InMemoryTaskManager

Класс `InMemoryTaskManager` реализует интерфейс `TaskManager` и предоставляет функциональность для управления задачами, эпиками и подзадачами в памяти.
Он автоматически обновляет статусы эпиков при изменениях в подзадачах и интегрируется с историей просмотров.

---

## Особенности
- Хранит данные в **HashMap** для быстрого доступа по ID.
- Автоматически генерирует уникальные ID через счетчик `idCounter`.
- Поддерживает историю просмотров через `HistoryManager`.
- Обеспечивает целостность данных (например, удаление подзадач при удалении эпика).

---

## Поля класса

| Поле                        | Тип                   | Описание                                      |
|-----------------------------|-----------------------|-----------------------------------------------|
| `idCounter`                 | `int`                 | Счетчик для генерации уникальных ID.          |
| `tasks`                     | `Map<Integer, Task>`  | Хранилище обычных задач.                      |
| `epics`                     | `Map<Integer, Epic>`  | Хранилище эпиков.                             |
| `subtasks`                  | `Map<Integer, Subtask>` | Хранилище подзадач.                          |
| `inMemoryHistoryManager`    | `HistoryManager`      | Менеджер истории просмотров задач.            |

---

## Конструктор

### `public InMemoryTaskManager()`
Инициализирует пустые хранилища задач и подключает дефолтный `HistoryManager`.

---

## Основные методы

### 1. **Добавление задач**
#### `addTask(Task task)`, `addEpic(Epic epic)`, `addSubtask(Subtask subtask)`
- Генерируют уникальный ID, устанавливают его задаче и сохраняют в соответствующее хранилище.
- Для подзадач:
    - Проверяют существование родительского эпика.
    - Обновляют статус эпика через `updateEpicStatus()`.

**Возвращают**: ID созданной задачи или `null` при ошибке (например, если эпик не найден).

---

### 2. **Получение задач**
#### `getTask(int id)`, `getEpic(int id)`, `getSubtask(int id)`
- Возвращают задачу по ID и добавляют её в историю просмотров.
- Если задача не найдена, возвращают `null`.

---

### 3. **Получение списков**
#### `getTasks()`, `getEpics()`, `getSubtasks()`, `getEpicSubtasks(int epicId)`
- Возвращают списки всех задач, эпиков, подзадач или подзадач конкретного эпика.
- Для `getEpicSubtasks()`:
    - Возвращает `null`, если эпик не существует.

---

### 4. **Обновление задач**
#### `updateTask(Task task)`, `updateEpic(Epic epic)`, `updateSubtask(Subtask subtask)`
- Заменяют старую версию задачи на новую.
- Для эпиков сохраняют текущие подзадачи и статус.
- Для подзадач обновляют статус родительского эпика.

---

### 5. **Удаление задач**
#### `deleteTask(int id)`, `deleteEpic(int id)`, `deleteSubtask(int id)`
- Удаляют задачу по ID.
- Удаление эпика также приводит к удалению всех его подзадач.
- Удаление подзадачи обновляет статус родительского эпика.

#### Групповое удаление
- `deleteAll()` — очищает все хранилища.
- `deleteTasks()`, `deleteEpics()`, `deleteSubtasks()` — удаляют все задачи определенного типа.

---

### 6. **Управление статусами эпиков**
#### `updateEpicStatus(int epicId)`
Автоматически вычисляет статус эпика на основе подзадач:
- **NEW** — если все подзадачи новые или их нет.
- **DONE** — если все подзадачи завершены.
- **IN_PROGRESS** — в остальных случаях.

---

### 7. **Работа с историей**
- `getHistory()` — возвращает историю просмотров.
- `remove(int id)` — удаляет задачу из истории.

---

## Пример использования
```java
TaskManager manager = new InMemoryTaskManager();

// Создание эпика и подзадачи
Epic epic = new Epic("Релиз", "Подготовка к выпуску");
int epicId = manager.addEpic(epic);

Subtask subtask = new Subtask("Тестирование", "Написать тесты", epicId);
int subtaskId = manager.addSubtask(subtask);

// Обновление статуса подзадачи
subtask.setStatus(Status.DONE);
manager.updateSubtask(subtask);

// Проверка статуса эпика
Epic updatedEpic = manager.getEpic(epicId);
System.out.println(updatedEpic.getStatus()); // Status.DONE
```
## Связь с другими классами
Интерфейс TaskManager: Определяет контракт методов управления задачами.

Классы задач (Task, Epic, Subtask): Хранятся в менеджере и управляются через CRUD-операции.

InMemoryHistoryManager: Используется для отслеживания истории просмотров.

Managers: Предощает реализацию HistoryManager по умолчанию.

## Примечания

Ограничения:

Нет поддержки сохранения данных между сеансами (для этого используйте FileBackedTaskManager).

История хранится в памяти и очищается при завершении приложения.

Целостность данных: При удалении эпика/подзадачи связи обновляются автоматически.